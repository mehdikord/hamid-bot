# ربات تلگرام مدیریت CRM (Aiogram 3 - فارسی)

این ربات تلگرام با استفاده از Aiogram 3.x برای مدیریت داخلی تیم فروش ساخته شده است. ربات مدیران و فروشندگان را به هم متصل می‌کند و بر اساس معماری مبتنی بر کامپوننت طراحی شده است.

## ویژگی‌های اصلی

- **ارجاع مشتری**: مدیران می‌توانند مشتریان جدید را به فروشندگان ارجاع دهند
- **ثبت فعالیت**: فروشندگان می‌توانند تماس‌ها، پیگیری‌ها و سایر فعالیت‌ها را ثبت کنند
- **یادآورها**: ثبت یادآورهای شخصی برای مدیران و فروشندگان
- **گزارش‌گیری**: گزارش‌های روزانه خودکار
- **رابط کاربری فارسی**: تمام متن‌ها و دکمه‌ها به زبان فارسی

## نصب و راه‌اندازی

### 1. نیازمندی‌ها
```bash
pip install -r requirements.txt
```

### 2. پیکربندی

#### الف) کپی کردن فایل تنظیمات:
```bash
cp config_template.py config.py
```

#### ب) ویرایش فایل config.py
فایل `config.py` را با اطلاعات خود ویرایش کنید:

```python
# توکن ربات از BotFather
BOT_TOKEN = "YOUR_BOT_TOKEN"

# شناسه‌های تلگرام مدیران و فروشندگان
MANAGER_IDS = [123456789]  # شناسه تلگرام مدیران
SELLER_IDS = [987654321]   # شناسه تلگرام فروشندگان

# نام‌های نمایشی (اختیاری)
USER_NAMES = {
    123456789: "علی مدیر",
    987654321: "رضا فروشنده"
}

# شناسه گروه برای گزارش‌های تیمی
GROUP_CHAT_ID = -1001234567890
```

#### ج) نحوه دریافت شناسه‌های تلگرام
- **شناسه کاربر**: به @userinfobot پیام دهید
- **شناسه گروه**: @userinfobot را به گروه اضافه کنید و /start بزنید

### 3. اجرای ربات
```bash
python main.py
```

## نحوه استفاده

### برای مدیران:
1. **📌 ارجاع مشتری**: مشتری جدید به فروشنده ارجاع دهید
2. **💰 ثبت پرداخت**: پرداخت دریافتی را ثبت کنید
3. **🔔 ثبت یادآور**: یادآور شخصی تنظیم کنید
4. **📊 گزارش‌ها**: گزارش روزانه تیم را مشاهده کنید

### برای فروشندگان:
1. **دریافت ارجاع**: پیام‌های ارجاع مشتری از مدیر دریافت کنید
2. **ثبت فعالیت**: 
   - 📞 ثبت تماس
   - 🔔 ثبت پیگیری  
   - ✅ تغییر وضعیت
   - 📝 افزودن یادداشت
3. **🔔 ثبت یادآور**: یادآور شخصی تنظیم کنید

## ساختار پروژه

```
project_root/
├── main.py              # نقطه ورود ربات
├── config.py            # تنظیمات ربات
├── requirements.txt     # وابستگی‌ها
├── handlers/           # کنترل‌کننده‌های ربات
│   ├── common.py       # دستورات عمومی
│   ├── assignments.py  # مدیریت ارجاعات
│   ├── reminders.py    # مدیریت یادآورها
│   ├── payments.py     # مدیریت پرداخت‌ها
│   └── reports.py      # گزارش‌گیری
├── services/           # منطق کسب‌وکار
├── keyboards/          # صفحه‌کلیدهای داخلی
└── utils/              # ابزارهای کمکی
```

## نکات فنی

- استفاده از API خارجی برای مدیریت داده‌ها
- رابط کاربری مبتنی بر دکمه‌های داخلی (بدون دستورات)
- معماری آسنکرون برای عملکرد بهتر
- منطقه زمانی: آسیا/تهران

## نکات امنیتی

- فقط کاربران مجاز (در لیست‌های MANAGER_IDS و SELLER_IDS) می‌توانند از ربات استفاده کنند
- فایل `config.py` در `.gitignore` قرار دارد و به گیت ارسال نمی‌شود
- توکن ربات و شناسه‌های کاربران را محرمانه نگه دارید
- برای محیط تولید، از webhook به جای polling استفاده کنید

## فایل‌های نادیده گرفته شده (.gitignore)

پروژه شامل فایل `.gitignore` کامل است که موارد زیر را نادیده می‌گیرد:
- فایل‌های پایتون کامپایل شده (`__pycache__/`, `*.pyc`)
- محیط‌های مجازی (`venv/`, `.venv/`)
- فایل‌های تنظیمات حساس (`config.py`)
- فایل‌های موقت و لاگ
- فایل‌های سیستم عامل (`.DS_Store`, `Thumbs.db`)

## توسعه

برای افزودن ویژگی‌های جدید:

1. Router جدید در پوشه `handlers/` ایجاد کنید
2. سرویس مربوطه در `services/` اضافه کنید  
3. Router را در `main.py` ثبت کنید

## پشتیبانی

این ربات برای استفاده داخلی تیم‌های فروش طراحی شده است. برای راهنمایی بیشتر، مستندات Aiogram 3 را مطالعه کنید.
